function reflect_q1_to_q2 () {
    for (let i = 0; i <= q1.height - 1; i++) {
        for (let j = 0; j <= q1.width - 1; j++) {
            q2.image.setPixel(q2.width - j - 1, i, q1.image.getPixel(j, i))
        }
    }
}
controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    do_one_pattern()
})
function do_one_pattern () {
    q1 = sprites.create(img`
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        `, SpriteKind.Player)
    set_left_and_top(q1, 20, 0)
    q2 = sprites.create(img`
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        `, SpriteKind.Player)
    set_left_and_top(q2, 80, 0)
    q3 = sprites.create(img`
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        `, SpriteKind.Player)
    set_left_and_top(q3, 80, 60)
    q4 = sprites.create(img`
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        ............................................................
        `, SpriteKind.Player)
    set_left_and_top(q4, 20, 60)
    fillRandom(q1, pixels_per_cell_side)
    reflect_q1_to_q2()
    reflect_q1_to_q3()
    reflect_q1_to_q4()
}
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    create_colors_list(nColors)
    do_one_pattern()
})
function reflect_q1_to_q3 () {
    for (let i = 0; i <= q1.height - 1; i++) {
        for (let j = 0; j <= q1.width - 1; j++) {
            q3.image.setPixel(q3.width - j - 1, q3.height - i - 1, q1.image.getPixel(j, i))
        }
    }
}
function fillRandom (q: Sprite, cell_size: number) {
    for (let i = 0; i <= q.height / cell_size; i++) {
        for (let j = 0; j <= q.width / cell_size; j++) {
            base_i = cell_size * i
            base_j = cell_size * j
            rColor = colors[randint(0, colors.length - 1)]
            for (let cell_i = 0; cell_i <= cell_size - 1; cell_i++) {
                for (let cell_j = 0; cell_j <= cell_size - 1; cell_j++) {
                    q.image.setPixel(base_j + cell_j, base_i + cell_i, rColor)
                }
            }
        }
    }
}
function set_left_and_top (mySprite: Sprite, left: number, top: number) {
    mySprite.left = left
    mySprite.top = top
}
function get_number_of_colors () {
    possible_nColors = [2, 3, 3, 4, 5]
    ndx = 0
    while (!(game.ask("number of colors: " + possible_nColors[ndx]))) {
        ndx += 1
        ndx = ndx % possible_nColors.length
    }
    return possible_nColors[ndx]
}
function reflect_q1_to_q4 () {
    for (let i = 0; i <= q1.height - 1; i++) {
        for (let j = 0; j <= q1.width - 1; j++) {
            q4.image.setPixel(j, q4.height - i - 1, q1.image.getPixel(j, i))
        }
    }
}
function create_colors_list (n: number) {
    colors = []
    for (let index = 0; index < n; index++) {
        colors.push(randint(1, 15))
    }
}
controller.A.onEvent(ControllerButtonEvent.Repeated, function () {
    pixels_per_cell_side = get_pixels_per_cell_side()
    nColors = get_number_of_colors()
    create_colors_list(nColors)
    do_one_pattern()
})
function get_pixels_per_cell_side () {
    possible_cell_sizes = [2, 4, 8, 16, 5]
    ndx = 0
    while (!(game.ask("pixels in cell side: " + possible_cell_sizes[ndx]))) {
        ndx += 1
        ndx = ndx % possible_cell_sizes.length
    }
    return possible_nColors[ndx]
}
let possible_cell_sizes: number[] = []
let ndx = 0
let possible_nColors: number[] = []
let rColor = 0
let base_j = 0
let base_i = 0
let q4: Sprite = null
let q3: Sprite = null
let q2: Sprite = null
let q1: Sprite = null
let nColors = 0
let colors: number[] = []
let pixels_per_cell_side = 0
pixels_per_cell_side = 4
colors = []
nColors = 2
create_colors_list(nColors)
do_one_pattern()
